(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{c4FF:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var l=function(){return function(){this.id=0,this.email="",this.name="",this.ruc="",this.identification="",this.main_phone_number="",this.secondary_phone_number="",this.address="",this.address_map_latitude=-.2153676,this.address_map_longitude=-78.5036064}}()},yUkU:function(e,t,n){"use strict";n.r(t);var l=n("CcnG"),i=function(){return function(){}}(),r=n("pMnS"),s=n("Vnl2"),a=n("9AJC"),u=n("4GxJ"),o=n("Ip0R"),c=n("cfkQ"),g=n("z8lh"),d=n("ZYjt"),p=n("SwDF"),f=n("/gWu"),h=n("3Nac"),m=n("c4FF"),v=n("teKj"),b=n("pQVB"),R=function(){function e(e,t,n,l){this.registerDataService=e,this.userDataService=t,this.register_typeDataService=n,this.stateDataService=l,this.alowed_capacity_types=[],this.registers_mintur=[],this.registerMinturSelected=new f.a,this.user=new m.a,this.config={paging:!0,filtering:{filterString:""},className:["table-striped","table-hover","table-bordered"]},this.rowsRegister=[],this.columnsRegister=[],this.dataRegister=[],this.currentPageRegister=1,this.lastPageRegister=1,this.recordsByPageRegister=5,this.states=[],this.estado_tramite_selected_code="1",this.register_types=[]}return e.prototype.ngOnInit=function(){this.getUser(),this.getStates()},e.prototype.refresh=function(){this.getRegistersMintur()},e.prototype.getStates=function(){var e=this;this.states=[],this.stateDataService.get().then(function(t){e.states=t,e.getRegisterTypes(),e.getSpecificStates()}).catch(function(e){console.log(e)})},e.prototype.getRegisterTypes=function(){var e=this;this.register_typeDataService.get().then(function(t){e.register_types=t}).catch(function(e){console.log(e)})},e.prototype.getSpecificStates=function(){var e=this;this.specific_states=[],this.states.forEach(function(t){t.father_code==e.estado_tramite_selected_code&&e.specific_states.push(t)})},e.prototype.getUser=function(){var e=this;this.userDataService.get(JSON.parse(sessionStorage.getItem("user")).id).then(function(t){e.user=t,e.refresh()}).catch(function(e){return console.log(e)})},e.prototype.getRegistersMintur=function(){var e=this;this.registers_mintur=[],this.registerMinturSelected=new f.a,this.registerDataService.get_registers_by_ruc(this.user.ruc).then(function(t){e.registers_mintur=t,e.registers_mintur.length>0&&e.buildDataTableRegister()}).catch(function(e){return console.log(e)})},e.prototype.onChangeTableRegister=function(e,t){void 0===t&&(t={page:this.currentPageRegister,itemsPerPage:this.recordsByPageRegister}),e.filtering&&Object.assign(this.config.filtering,e.filtering),e.sorting&&Object.assign(this.config.sorting,e.sorting);var n=this.changeFilterRegister(this.dataRegister,this.config),l=this.changeSortRegister(n,this.config);this.rowsRegister=t&&e.paging?this.changePageRegister(t,l):l},e.prototype.changeFilterRegister=function(e,t){var n=this;this.rowsRegister.forEach(function(e){e.selected=""});var l=e;if(this.columnsRegister.forEach(function(e){e.filtering&&(l=l.filter(function(t){return t[e.name].match(e.filtering.filterString)}))}),!t.filtering)return l;if(t.filtering.columnName)return l.filter(function(e){return e[t.filtering.columnName].match(n.config.filtering.filterString)});var i=[];return l.forEach(function(e){var t=!1;n.columnsRegister.forEach(function(l){e[l.name].toString().match(n.config.filtering.filterString)&&(t=!0)}),t&&i.push(e)}),l=i},e.prototype.changeSortRegister=function(e,t){if(!t.sorting)return e;for(var n=this.config.sorting.columns||[],l=void 0,i=void 0,r=0;r<n.length;r++)""!==n[r].sort&&!1!==n[r].sort&&(l=n[r].name,i=n[r].sort);return l?e.sort(function(e,t){return e[l]>t[l]?"desc"===i?-1:1:e[l]<t[l]?"asc"===i?-1:1:0}):e},e.prototype.changePageRegister=function(e,t){void 0===t&&(t=this.dataRegister);var n=(e.page-1)*e.itemsPerPage;return t.slice(n,e.itemsPerPage>-1?n+e.itemsPerPage:t.length)},e.prototype.buildDataTableRegister=function(){var e=this;this.columnsRegister=[{title:"Seleccionado",name:"selected"},{title:"C\xf3digo del Establecimiento",name:"establishment_code"},{title:"Ubicaci\xf3n del Establecimiento",name:"address"},{title:"C\xf3digo del Registro",name:"register_code"},{title:"Tipo de Registro",name:"register_type"},{title:"Estado",name:"state"},{title:"Observaciones",name:"notes"}];var t=[];this.registers_mintur.forEach(function(n){var l=new Date,i=e.getRegisterState(n.status_register.state_id);0==i.search("Aprobado")&&(l=new Date(n.status_register.updated_at)),0==i.search("Negado")&&(l=new Date(n.status_register.updated_at));var r=new Date(n.register.updated_at),s=Math.abs(r.getTime()-l.getTime()),a=Math.ceil(s/864e5);a<7&&a.toString(),a>=7&&a<=10&&a.toString(),a>10&&a.toString(),t.push({selected:"",id:n.register.id,establishment_code:n.establishment.ruc_code_id,address:n.establishment.address_main_street+" "+n.establishment.address_number+" "+n.establishment.address_secondary_street,register_code:n.register.code,register_type:n.type.register_category.name+" / "+n.type.register_type.name,state:i,notes:'<div class="col-12 text-justify">'+n.status_register.justification+"</div>"})}),this.dataRegister=t,this.onChangeTableRegister(this.config)},e.prototype.onCellClickRegister=function(e){var t=this;this.registers_mintur.forEach(function(n){n.register.id==e.row.id&&t.selectRegister(n.register)}),this.rowsRegister.forEach(function(t){t.selected=t.id==e.row.id?'<div class="col-12 text-right"><span class="far fa-hand-point-right"></span></div>':""})},e.prototype.selectRegister=function(e){this.registerDataService.get_tarifario(e.id).then(function(e){console.log(e)}).catch(function(e){console.log(e)})},e.prototype.getRegisterState=function(e){var t="",n="";return this.states.forEach(function(l){l.id==e&&(t=l.name,n=l.father_code)}),this.states.forEach(function(e){e.code==n&&(t=e.name+" - "+t)}),t},e}(),_=l["\u0275crt"]({encapsulation:0,styles:[[""]],data:{}});function y(e){return l["\u0275vid"](0,[(e()(),l["\u0275eld"](0,0,null,null,1,"input",[["class","form-control"],["placeholder","Buscar..."]],null,[[null,"input"]],function(e,t,n){var i=!0,r=e.component;return"input"===t&&(i=!1!==l["\u0275nov"](e,1).onChangeFilter(n.target.value)&&i),"input"===t&&(i=!1!==r.onChangeTableRegister(r.config)&&i),i},null,null)),l["\u0275did"](1,16384,null,0,s.NgTableFilteringDirective,[l.ElementRef,l.Renderer],{ngTableFiltering:[0,"ngTableFiltering"]},null)],function(e,t){e(t,1,0,t.component.config.filtering)},null)}function S(e){return l["\u0275vid"](0,[(e()(),l["\u0275ted"](-1,null,["Primera"]))],null,null)}function C(e){return l["\u0275vid"](0,[(e()(),l["\u0275ted"](-1,null,["Anterior"]))],null,null)}function w(e){return l["\u0275vid"](0,[(e()(),l["\u0275ted"](-1,null,["Siguiente"]))],null,null)}function T(e){return l["\u0275vid"](0,[(e()(),l["\u0275ted"](-1,null,["\xdaltima"]))],null,null)}function k(e){return l["\u0275vid"](0,[(e()(),l["\u0275eld"](0,0,null,null,15,"ngb-pagination",[["role","navigation"]],null,[[null,"pageChange"]],function(e,t,n){var l=!0,i=e.component;return"pageChange"===t&&(l=!1!==(i.currentPageRegister=n)&&l),"pageChange"===t&&(l=!1!==i.onChangeTableRegister(i.config,n)&&l),l},a.g,a.d)),l["\u0275did"](1,573440,null,6,u.C,[u.D],{boundaryLinks:[0,"boundaryLinks"],collectionSize:[1,"collectionSize"],maxSize:[2,"maxSize"],page:[3,"page"],pageSize:[4,"pageSize"]},{pageChange:"pageChange"}),l["\u0275qud"](335544320,1,{tplEllipsis:0}),l["\u0275qud"](335544320,2,{tplFirst:0}),l["\u0275qud"](335544320,3,{tplLast:0}),l["\u0275qud"](335544320,4,{tplNext:0}),l["\u0275qud"](335544320,5,{tplNumber:0}),l["\u0275qud"](335544320,6,{tplPrevious:0}),(e()(),l["\u0275and"](0,null,null,1,null,S)),l["\u0275did"](9,16384,[[2,4]],0,u.E,[l.TemplateRef],null,null),(e()(),l["\u0275and"](0,null,null,1,null,C)),l["\u0275did"](11,16384,[[6,4]],0,u.I,[l.TemplateRef],null,null),(e()(),l["\u0275and"](0,null,null,1,null,w)),l["\u0275did"](13,16384,[[4,4]],0,u.H,[l.TemplateRef],null,null),(e()(),l["\u0275and"](0,null,null,1,null,T)),l["\u0275did"](15,16384,[[3,4]],0,u.F,[l.TemplateRef],null,null)],function(e,t){var n=t.component;e(t,1,0,!0,n.registers_mintur.length,10,n.currentPageRegister,n.recordsByPageRegister)},null)}function D(e){return l["\u0275vid"](0,[(e()(),l["\u0275eld"](0,0,null,null,2,"div",[["class","row"]],null,null,null,null,null)),(e()(),l["\u0275eld"](1,0,null,null,1,"h1",[["class","col-12 text-right"]],null,null,null,null,null)),(e()(),l["\u0275ted"](-1,null,[" Tarifario Rack "])),(e()(),l["\u0275eld"](3,0,null,null,8,"div",[["class","row"]],null,null,null,null,null)),(e()(),l["\u0275eld"](4,0,null,null,7,"div",[["class","col-12"]],null,null,null,null,null)),(e()(),l["\u0275eld"](5,0,null,null,6,"div",[["class","btn-toolbar"],["role","toolbar"]],null,null,null,null,null)),(e()(),l["\u0275eld"](6,0,null,null,2,"div",[["class","btn-group mr-2"],["role","group"]],null,null,null,null,null)),(e()(),l["\u0275eld"](7,0,null,null,1,"button",[["class","btn btn-primary"],["title","Actualizar"],["type","button"]],null,[[null,"click"]],function(e,t,n){var l=!0,i=e.component;return"click"===t&&(l=!1!==i.onChangeTableRegister(i.config)&&l),l},null,null)),(e()(),l["\u0275eld"](8,0,null,null,0,"i",[["class","fas fa-sync"]],null,null,null,null,null)),(e()(),l["\u0275eld"](9,0,null,null,2,"div",[["class","btn-group mr-2"],["role","group"]],null,null,null,null,null)),(e()(),l["\u0275and"](16777216,null,null,1,null,y)),l["\u0275did"](11,16384,null,0,o.NgIf,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),l["\u0275eld"](12,0,null,null,4,"div",[["style","width: 100%; overflow-x: auto;"]],null,null,null,null,null)),(e()(),l["\u0275eld"](13,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(e()(),l["\u0275eld"](14,0,null,null,2,"div",[["class","col-12 mt-2"]],null,null,null,null,null)),(e()(),l["\u0275eld"](15,0,null,null,1,"ng-table",[],null,[[null,"cellClicked"],[null,"tableChanged"]],function(e,t,n){var l=!0,i=e.component;return"cellClicked"===t&&(l=!1!==i.onCellClickRegister(n)&&l),"tableChanged"===t&&(l=!1!==i.onChangeTableRegister(i.config)&&l),l},c.b,c.a)),l["\u0275did"](16,49152,null,0,g.NgTableComponent,[d.DomSanitizer],{rows:[0,"rows"],config:[1,"config"],columns:[2,"columns"]},{tableChanged:"tableChanged",cellClicked:"cellClicked"}),(e()(),l["\u0275eld"](17,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(e()(),l["\u0275eld"](18,0,null,null,2,"div",[["class","col-12"]],null,null,null,null,null)),(e()(),l["\u0275and"](16777216,null,null,1,null,k)),l["\u0275did"](20,16384,null,0,o.NgIf,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(e,t){var n=t.component;e(t,11,0,n.config.filtering),e(t,16,0,n.rowsRegister,n.config,n.columnsRegister),e(t,20,0,n.config.paging)},null)}function P(e){return l["\u0275vid"](0,[(e()(),l["\u0275eld"](0,0,null,null,1,"app-tarifario-rack",[],null,null,null,D,_)),l["\u0275did"](1,114688,null,0,R,[h.a,v.a,b.a,p.a],null,null)],function(e,t){e(t,1,0)},null)}var F=l["\u0275ccf"]("app-tarifario-rack",R,P,{},{},[]),E=n("gIcY"),N=n("sE5F"),I=n("ZYCi"),M=function(){return function(){}}(),z=n("kY/A");n.d(t,"TarifarioRackModuleNgFactory",function(){return j});var j=l["\u0275cmf"](i,[],function(e){return l["\u0275mod"]([l["\u0275mpd"](512,l.ComponentFactoryResolver,l["\u0275CodegenComponentFactoryResolver"],[[8,[r.a,F,a.a,a.b,a.l,a.m,a.i,a.j,a.k]],[3,l.ComponentFactoryResolver],l.NgModuleRef]),l["\u0275mpd"](4608,o.NgLocalization,o.NgLocaleLocalization,[l.LOCALE_ID,[2,o["\u0275angular_packages_common_common_a"]]]),l["\u0275mpd"](4608,E.s,E.s,[]),l["\u0275mpd"](4608,u.y,u.y,[l.ComponentFactoryResolver,l.Injector,u.tb,u.z]),l["\u0275mpd"](4608,h.a,h.a,[N.e,I.l]),l["\u0275mpd"](4608,v.a,v.a,[N.e]),l["\u0275mpd"](4608,p.a,p.a,[N.e,I.l]),l["\u0275mpd"](4608,b.a,b.a,[N.e,I.l]),l["\u0275mpd"](1073742336,o.CommonModule,o.CommonModule,[]),l["\u0275mpd"](1073742336,I.o,I.o,[[2,I.u],[2,I.l]]),l["\u0275mpd"](1073742336,M,M,[]),l["\u0275mpd"](1073742336,E.p,E.p,[]),l["\u0275mpd"](1073742336,E.e,E.e,[]),l["\u0275mpd"](1073742336,u.c,u.c,[]),l["\u0275mpd"](1073742336,u.f,u.f,[]),l["\u0275mpd"](1073742336,u.g,u.g,[]),l["\u0275mpd"](1073742336,u.k,u.k,[]),l["\u0275mpd"](1073742336,u.l,u.l,[]),l["\u0275mpd"](1073742336,u.q,u.q,[]),l["\u0275mpd"](1073742336,u.v,u.v,[]),l["\u0275mpd"](1073742336,u.A,u.A,[]),l["\u0275mpd"](1073742336,u.G,u.G,[]),l["\u0275mpd"](1073742336,u.Q,u.Q,[]),l["\u0275mpd"](1073742336,u.T,u.T,[]),l["\u0275mpd"](1073742336,u.W,u.W,[]),l["\u0275mpd"](1073742336,u.bb,u.bb,[]),l["\u0275mpd"](1073742336,u.fb,u.fb,[]),l["\u0275mpd"](1073742336,u.gb,u.gb,[]),l["\u0275mpd"](1073742336,u.hb,u.hb,[]),l["\u0275mpd"](1073742336,u.B,u.B,[]),l["\u0275mpd"](1073742336,z.Ng2TableModule,z.Ng2TableModule,[]),l["\u0275mpd"](1073742336,i,i,[]),l["\u0275mpd"](1024,I.j,function(){return[[{path:"",component:R}]]},[])])})}}]);